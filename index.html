<head>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>
</head>
<body>
  <h1 class="md-typescale-display-medium">Quizz Epistemologie</h1>
  <md-linear-progress id="progress" value="0"></md-linear-progress>
  <form id="mainForm">
    <p id="quizz" class="md-typescale-body-medium">Check out these controls in a form!</p>
    <md-outlined-button type="reset" onclick="Aclicked()">A</md-outlined-button>
    <md-outlined-button type="reset" onclick="Bclicked()">B</md-outlined-button>
    <md-outlined-button type="reset"onclick="Cclicked()">C</md-outlined-button>
  </form>
  <style>
    form {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 16px;
    }
  </style>
  <script>
    NO_ANSWER = "X"
    CURRENT_QUESTION = 0

    QUIZZ_ELEMENT = document.getElementById("mainForm")

 

    questions = ["Comment définiriez-vous la nature de la réalité ?",
    "Quelle est votre opinion sur la possibilité de connaître la réalité ?",
    "Comment considérez-vous la production de la connaissance scientifique ?",
    "Comment percevez-vous le rôle des valeurs personnelles et des croyances dans la formation des connaissances ?",
    "Comment évaluez-vous la validité de la connaissance scientifique produite ?",
    "Quelle est votre attitude envers les biais et la subjectivité dans la connaissance scientifique ?",
    "Quelle est votre attitude envers le rôle des contextes sociaux et historique dans la production de la connaissance ?",
    "Comment percevez-vous la relation entre théorie et observation ?"
    ]
    answers = new Map()
    for(q in questions)
    {
        answers.set(questions[q],NO_ANSWER)
    }
    console.log(answers)
    update()

    function update()
    {
        elem = document.getElementById("quizz")
        elem.innerHTML = questions[CURRENT_QUESTION]

        prog = document.getElementById("progress")
        val = CURRENT_QUESTION/questions.length*1.0
        prog.value = ""+ val

        if(val == 1.0)
            quizzEnd()
    }

    function initQuizz()
    {
      QUIZZ_ELEMENT.innerHTML = '<p id="quizz" class="md-typescale-body-medium">Question</p>'+
      '<md-outlined-button type="reset" onclick="Aclicked()">A</md-outlined-button>'+
      '<md-outlined-button type="reset" onclick="Bclicked()">B</md-outlined-button>' +
      '<md-outlined-button type="reset"onclick="Cclicked()">C</md-outlined-button>'

      CURRENT_QUESTION = 0
      update()
    }

    function quizzEnd()
    {
        QUIZZ_ELEMENT.innerHTML = '<p id="quizz" class="md-typescale-body-medium">Le quizz est fini.Merci.</p>'+
        '<md-outlined-button type="reset" onclick="initQuizz()">Recommencer le quizz ?</md-outlined-button>'
        
        //SHOULD DISPLAY THE NUMBER OF ANSWERS BY ITEM
    }

    // This function is used to classify the epistemological stand of the user
    function classify()
    {
      assert(true == false)
    }

    // @TODO
    function getResultsByItems()
    {
        results = new Map()

        for(let i = 0 ; i < CURRENT_QUESTION; i++)
        {
            answers.get(questions[i])
        }
        assert(true==false)
    }

    function Aclicked()
    {
        buttonClicked("A")
    }

    function Bclicked()
    {
        buttonClicked("B")
    }

    function Cclicked()
    {
        buttonClicked("C")
    }

    function buttonClicked(ans)
    {
        answers.set(questions[CURRENT_QUESTION], ans)
        CURRENT_QUESTION++
        update()
    }
  </script>
</body>